!function(){"use strict"}();var app=angular.module("ConsoleNotepad",["ngRoute"]);app.directive("contenteditable",function(){return{restrict:"A",require:"?ngModel",link:function(t,e,n,o){function s(){var t=e.html();n.stripBr&&"<br>"==t&&(t=""),o.$setViewValue(t)}o&&(o.$render=function(){e.html(o.$viewValue||"")},e.on("blur keyup change",function(){t.$apply(s)}),s())}}}),app.directive("focusOn",function(){return function(t,e,n){t.$on("focusOn",function(t,o){o===n.focusOn&&e[0].focus()})}}),app.factory("focusOn",function(t,e){return function(n){e(function(){t.$broadcast("focusOn",n)})}}),app.controller("editorController",function(t,e,n,o){function s(e){var o=t.parts[e];n.put(o)}function r(e){var s=e+1;null==e&&(s=0),t.parts.splice(s,0,{Data:"new"}),o("part"+s),n.post(t.parts[s])}function a(){(0==t.parts.length||null==t.parts)&&r()}t.suggestions={},t.highlightedSuggestion=-1,t.currentNoteId=0,t.parts=[{Data:"new"}];var i;t.focusOnPart=0,t.smartBarKeyDown=function(o){if(console.log("Refresh "+o.keyCode),32==o.keyCode&&(t.suggestions=e.getSuggested(t.smartBar).success(function(e){console.table(e),t.suggestions=e}),console.log("Refreshed")),40==o.keyCode&&t.highlightedSuggestion<t.suggestions.length-1&&(o.preventDefault(),t.highlightedSuggestion++),38==o.keyCode&&t.highlightedSuggestion>-1&&(o.preventDefault(),t.highlightedSuggestion--),13==o.keyCode&&t.highlightedSuggestion>-1){t.smartBar="",console.table(t.suggestions[t.highlightedSuggestion].NoteTags);var s=t.suggestions[t.highlightedSuggestion];console.table(s);for(var r in s.NoteTags)t.smartBar+=s.NoteTags[r].Tag.Name+" ";t.currentNoteId=s.NoteId,t.parts=n.get(t.currentNoteId).success(function(e){t.parts=e,a()})}},t.editingPartKeyDown=function(e,n){clearTimeout(i),i=setTimeout(function(){s(n)},3e3);var o=t.parts[n];13==e.keyCode&&/\s*<br>\s*<br>\s*$/.test(o.Data)&&(t.parts[n].Data=t.parts[n].Data.replace(/\s*<br>\s*$/g,""),r(n),e.preventDefault())}}),app.factory("notes",["$http",function(t){var e={};return e.get=function(){},e.getSuggested=function(e){return t({method:"GET",url:"/api/notes/suggested?searchText="+e,headers:{Accept:"application/json"}})},e.post=function(t){},e.put=function(t){console.table(t)},e}]),app.factory("parts",["$http",function(t){var e={};return e.get=function(e){return t({method:"GET",url:"/api/parts?idOfNote="+e,headers:{Accept:"application/json"}})},e.post=function(e){return console.log("nextPart:"),console.table(e),t({method:"POST",url:"/api/Parts",data:e,headers:{Accept:"application/json"}})},e.put=function(t){},e}]);